/*! x509-1.1.14.js (c) 2012-2017 Kenji Urushima | kjur.github.com/jsrsasign/license
 */
function X509(){var j=ASN1HEX;var a=X509;var i=j.getChildIdx;var g=j.getV;var b=j.getTLV;var e=j.getVbyList;var c=j.getTLVbyList;var f=j.getIdxbyList;var d=j.getVidx;var h=j.oidname;this.hex=null;this.version=0;this.foffset=0;this.aExtInfo=null;this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.getVersion=function(){if(this.hex===null||this.version!==0){return this.version}if(c(this.hex,0,[0,0])!=="a003020102"){this.version=1;this.foffset=-1;return 1}this.version=3;return 3};this.getSerialNumberHex=function(){return e(this.hex,0,[0,1+this.foffset],"02")};this.getSignatureAlgorithmField=function(){return h(e(this.hex,0,[0,2+this.foffset,0],"06"))};this.getIssuerHex=function(){return c(this.hex,0,[0,3+this.foffset],"30")};this.getIssuerString=function(){return a.hex2dn(this.getIssuerHex())};this.getSubjectHex=function(){return c(this.hex,0,[0,5+this.foffset],"30")};this.getSubjectString=function(){return a.hex2dn(this.getSubjectHex())};this.getNotBefore=function(){var k=e(this.hex,0,[0,4+this.foffset,0]);k=k.replace(/(..)/g,"%$1");k=decodeURIComponent(k);return k};this.getNotAfter=function(){var k=e(this.hex,0,[0,4+this.foffset,1]);k=k.replace(/(..)/g,"%$1");k=decodeURIComponent(k);return k};this.getPublicKeyHex=function(){return j.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKeyIdx=function(){return f(this.hex,0,[0,6+this.foffset],"30")};this.getPublicKey=function(){return KEYUTIL.getKey(this.getPublicKeyHex(),null,"pkcs8pub")};this.getSignatureAlgorithmName=function(){return h(e(this.hex,0,[1,0],"06"))};this.getSignatureValueHex=function(){return e(this.hex,0,[2],"03",true)};this.verifySignature=function(m){var n=this.getSignatureAlgorithmName();var k=this.getSignatureValueHex();var l=c(this.hex,0,[0],"30");var o=new KJUR.crypto.Signature({alg:n});o.init(m);o.updateHex(l);return o.verify(k)};this.parseExt=function(){if(this.version!==3){return -1}var o=f(this.hex,0,[0,7,0],"30");var l=i(this.hex,o);this.aExtInfo=new Array();for(var m=0;m<l.length;m++){var p={};p.critical=false;var k=i(this.hex,l[m]);var q=0;if(k.length===3){p.critical=true;q=1}p.oid=j.hextooidstr(e(this.hex,l[m],[0],"06"));var n=f(this.hex,l[m],[1+q]);p.vidx=d(this.hex,n);this.aExtInfo.push(p)}};this.getExtInfo=function(m){var k=this.aExtInfo;var n=m;if(!m.match(/^[0-9.]+$/)){n=KJUR.asn1.x509.OID.name2oid(m)}if(n===""){return undefined}for(var l=0;l<k.length;l++){if(k[l].oid===n){return k[l]}}return undefined};this.getExtBasicConstraints=function(){var m=this.getExtInfo("basicConstraints");if(m===undefined){return m}var k=g(this.hex,m.vidx);if(k===""){return{}}if(k==="0101ff"){return{cA:true}}if(k.substr(0,8)==="0101ff02"){var n=g(k,6);var l=parseInt(n,16);return{cA:true,pathLen:l}}throw"basicConstraints parse error"};this.getExtKeyUsageBin=function(){var n=this.getExtInfo("keyUsage");if(n===undefined){return""}var l=g(this.hex,n.vidx);if(l.length%2!=0||l.length<=2){throw"malformed key usage value"}var k=parseInt(l.substr(0,2));var m=parseInt(l.substr(2),16).toString(2);return m.substr(0,m.length-k)};this.getExtKeyUsageString=function(){var m=this.getExtKeyUsageBin();var k=new Array();for(var l=0;l<m.length;l++){if(m.substr(l,1)=="1"){k.push(X509.KEYUSAGE_NAME[l])}}return k.join(",")};this.getExtSubjectKeyIdentifier=function(){var k=this.getExtInfo("subjectKeyIdentifier");if(k===undefined){return k}return g(this.hex,k.vidx)};this.getExtAuthorityKeyIdentifier=function(){var o=this.getExtInfo("authorityKeyIdentifier");if(o===undefined){return o}var k={};var n=b(this.hex,o.vidx);var l=i(n,0);for(var m=0;m<l.length;m++){if(n.substr(l[m],2)==="80"){k.kid=g(n,l[m])}}return k};this.getExtExtKeyUsageName=function(){var o=this.getExtInfo("extKeyUsage");if(o===undefined){return o}var k=new Array();var n=b(this.hex,o.vidx);if(n===""){return k}var l=i(n,0);for(var m=0;m<l.length;m++){k.push(h(g(n,l[m])))}return k};this.getExtSubjectAltName=function(){var p=this.getExtInfo("subjectAltName");if(p===undefined){return p}var k=new Array();var o=b(this.hex,p.vidx);var l=i(o,0);for(var n=0;n<l.length;n++){if(o.substr(l[n],2)==="82"){var m=hextoutf8(g(o,l[n]));k.push(m)}}return k};this.getExtCRLDistributionPointsURI=function(){var o=this.getExtInfo("cRLDistributionPoints");if(o===undefined){return o}var k=new Array();var l=i(this.hex,o.vidx);for(var m=0;m<l.length;m++){var p=e(this.hex,l[m],[0,0,0],"86");var n=hextoutf8(p);k.push(n)}return k};this.getExtAIAInfo=function(){var o=this.getExtInfo("authorityInfoAccess");if(o===undefined){return o}var k={ocsp:[],caissuer:[]};var l=i(this.hex,o.vidx);for(var m=0;m<l.length;m++){var p=e(this.hex,l[m],[0],"06");var n=e(this.hex,l[m],[1],"86");if(p==="2b06010505073001"){k.ocsp.push(hextoutf8(n))}if(p==="2b06010505073002"){k.caissuer.push(hextoutf8(n))}}return k};this.getExtCertificatePolicies=function(){var n=this.getExtInfo("certificatePolicies");if(n===undefined){return n}var k=b(this.hex,n.vidx);var t=[];var r=i(k,0);for(var q=0;q<r.length;q++){var s={};var m=i(k,r[q]);s.id=h(g(k,m[0]));if(m.length===2){var l=i(k,m[1]);for(var p=0;p<l.length;p++){var o=e(k,l[p],[0],"06");if(o==="2b06010505070201"){s.cps=hextoutf8(e(k,l[p],[1]))}else{if(o==="2b06010505070202"){s.unotice=hextoutf8(e(k,l[p],[1,0]))}}}}t.push(s)}return t};this.readCertPEM=function(k){this.readCertHex(j.pemToHex(k))};this.readCertHex=function(k){this.hex=k;this.getVersion();this.parseExt();try{pubkey=this.getPublicKey();if(pubkey instanceof RSAKey){this.subjectPublicKeyRSA=pubkey;this.subjectPublicKeyRSA_hN=hextoposhex(pubkey.n.toString(16));this.subjectPublicKeyRSA_hE=hextoposhex(pubkey.e.toString(16))}}catch(l){}};this.readCertPEMWithoutRSAInit=function(l){var m=j.pemToHex(l);var k=a.getPublicKeyHexArrayFromCertHex(m);if(typeof this.subjectPublicKeyRSA.setPublic==="function"){this.subjectPublicKeyRSA.setPublic(k[0],k[1])}this.subjectPublicKeyRSA_hN=k[0];this.subjectPublicKeyRSA_hE=k[1];this.hex=m};this.getInfo=function(){var l=X509;var y,q,w;y="Basic Fields\n";y+="  serial number: "+this.getSerialNumberHex()+"\n";y+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";y+="  issuer: "+this.getIssuerString()+"\n";y+="  notBefore: "+this.getNotBefore()+"\n";y+="  notAfter: "+this.getNotAfter()+"\n";y+="  subject: "+this.getSubjectString()+"\n";y+="  subject public key info: \n";q=this.getPublicKey();y+="    key algorithm: "+q.type+"\n";if(q.type==="RSA"){y+="    n="+hextoposhex(q.n.toString(16)).substr(0,16)+"...\n";y+="    e="+hextoposhex(q.e.toString(16))+"\n"}y+="X509v3 Extensions:\n";w=this.aExtInfo;for(var o=0;o<w.length;o++){var m=w[o];var x=KJUR.asn1.x509.OID.oid2name(m.oid);if(x===""){x=m.oid}var u="";if(m.critical===true){u="CRITICAL"}y+="  "+x+" "+u+":\n";if(x==="basicConstraints"){var r=this.getExtBasicConstraints();if(r.cA===undefined){y+="    {}\n"}else{y+="    cA=true";if(r.pathLen!==undefined){y+=", pathLen="+r.pathLen}y+="\n"}}else{if(x==="keyUsage"){y+="    "+this.getExtKeyUsageString()+"\n"}else{if(x==="subjectKeyIdentifier"){y+="    "+this.getExtSubjectKeyIdentifier()+"\n"}else{if(x==="authorityKeyIdentifier"){var k=l.getExtAuthorityKeyIdentifier(this.hex);if(k.kid!==undefined){y+="    kid="+k.kid+"\n"}}else{if(x==="extKeyUsage"){var t=this.getExtExtKeyUsageName();y+="    "+t.join(", ")+"\n"}else{if(x==="subjectAltName"){var p=this.getExtSubjectAltName();y+="    "+p.join(", ")+"\n"}else{if(x==="cRLDistributionPoints"){var v=this.getExtCRLDistributionPointsURI();y+="    "+v+"\n"}else{if(x==="authorityInfoAccess"){var n=this.getExtAIAInfo();if(n.ocsp!==undefined){y+="    ocsp: "+n.ocsp.join(",")+"\n"}if(n.caissuer!==undefined){y+="    caissuer: "+n.caissuer.join(",")+"\n"}}}}}}}}}}y+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n";y+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n";return y}}X509.pemToBase64=function(a){var b=a;b=b.replace("-----BEGIN CERTIFICATE-----","");b=b.replace("-----END CERTIFICATE-----","");b=b.replace(/[ \n]+/g,"");return b};X509.pemToHex=function(a){return ASN1HEX.pemToHex(a)};X509.getSubjectPublicKeyPosFromCertHex=function(f){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(f);if(e==-1){return -1}var b=ASN1HEX.getChildIdx(f,e);if(b.length!=2){return -1}var d=b[1];if(f.substr(d,2)!="03"){return -1}var c=ASN1HEX.getVidx(f,d);if(f.substr(c,2)!="00"){return -1}return c+2};X509.getSubjectPublicKeyInfoPosFromCertHex=function(b){var a=new X509();a.readCertHex(b);return a.getPublicKeyIdx()};X509.getPublicKeyHexArrayFromCertHex=function(g){var d=ASN1HEX;var f,b,e,c;f=X509.getSubjectPublicKeyPosFromCertHex(g);b=d.getChildIdx(g,f);if(b.length!=2){return[]}e=d.getV(g,b[0]);c=d.getV(g,b[1]);if(e!=null&&c!=null){return[e,c]}else{return[]}};X509.getHexTbsCertificateFromCert=function(b){var a=ASN1HEX.getVidx(b,0);return a};X509.getPublicKeyHexArrayFromCertPEM=function(c){var d=ASN1HEX.pemToHex(c);var b=X509.getPublicKeyHexArrayFromCertHex(d);return b};X509.hex2dn=function(f,b){if(b===undefined){b=0}if(f.substr(b,2)!=="30"){throw"malformed DN"}var c=new Array();var d=ASN1HEX.getChildIdx(f,b);for(var e=0;e<d.length;e++){c.push(X509.hex2rdn(f,d[e]))}c=c.map(function(a){return a.replace("/","\\/")});return"/"+c.join("/")};X509.hex2rdn=function(f,b){if(b===undefined){b=0}if(f.substr(b,2)!=="31"){throw"malformed RDN"}var c=new Array();var d=ASN1HEX.getChildIdx(f,b);for(var e=0;e<d.length;e++){c.push(X509.hex2attrTypeValue(f,d[e]))}c=c.map(function(a){return a.replace("+","\\+")});return c.join("+")};X509.hex2attrTypeValue=function(d,i){var j=ASN1HEX;var h=j.getV;if(i===undefined){i=0}if(d.substr(i,2)!=="30"){throw"malformed attribute type and value"}var g=j.getChildIdx(d,i);if(g.length!==2||d.substr(g[0],2)!=="06"){"malformed attribute type and value"}var b=h(d,g[0]);var f=KJUR.asn1.ASN1Util.oidHexToInt(b);var e=KJUR.asn1.x509.OID.oid2atype(f);var a=h(d,g[1]);var c=hextorstr(a);return e+"="+c};X509.getPublicKeyFromCertHex=function(b){var a=new X509();a.readCertHex(b);return a.getPublicKey()};X509.getPublicKeyFromCertPEM=function(b){var a=new X509();a.readCertPEM(b);return a.getPublicKey()};X509.getPublicKeyInfoPropOfCertPEM=function(c){var e=ASN1HEX;var g=e.getVbyList;var b={};var a,f,d;b.algparam=null;a=new X509();a.readCertPEM(c);f=a.getPublicKeyHex();b.keyhex=g(f,0,[1],"03").substr(2);b.algoid=g(f,0,[0,0],"06");if(b.algoid==="2a8648ce3d0201"){b.algparam=g(f,0,[0,1],"06")}return b};X509.getPublicKeyInfoPosOfCertHEX=function(b){var a=new X509();a.readCertHex(b);return a.getPublicKeyIdx()};X509.getV3ExtInfoListOfCertHex=function(f){var d=ASN1HEX;var g=d.getIdxbyList(f,0,[0,7,0],"30");var e=d.getChildIdx(f,g);var c=e.length;var b=new Array(c);for(var a=0;a<c;a++){b[a]=X509.getV3ExtItemInfo_AtObj(f,e[a])}return b};X509.getV3ExtItemInfo_AtObj=function(g,h){var d=ASN1HEX;var f={};f.posTLV=h;var b=d.getChildIdx(g,h);if(b.length!=2&&b.length!=3){throw"malformed X.509v3 Ext (code:001)"}if(g.substr(b[0],2)!="06"){throw"malformed X.509v3 Ext (code:002)"}var e=d.getV(g,b[0]);f.oid=d.hextooidstr(e);f.critical=false;if(b.length==3){f.critical=true}var c=b[b.length-1];if(g.substr(c,2)!="04"){throw"malformed X.509v3 Ext (code:003)"}f.posV=d.getVidx(g,c);return f};X509.getHexOfTLV_V3ExtValue=function(c,b){var a=X509.getPosOfTLV_V3ExtValue(c,b);if(a==-1){return null}return ASN1HEX.getTLV(c,a)};X509.getHexOfV_V3ExtValue=function(c,b){var a=X509.getPosOfTLV_V3ExtValue(c,b);if(a==-1){return null}return ASN1HEX.getV(c,a)};X509.getPosOfTLV_V3ExtValue=function(f,b){var d=b;if(!b.match(/^[0-9.]+$/)){d=KJUR.asn1.x509.OID.name2oid(b)}if(d==""){return -1}var c=X509.getV3ExtInfoListOfCertHex(f);for(var a=0;a<c.length;a++){var e=c[a];if(e.oid==d){return e.posV}}return -1};X509.getExtBasicConstraints=function(b){var a=new X509();a.readCertHex(b);return a.getExtBasicConstraints()};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=function(b){var a=new X509();a.readCertHex(b);return a.getExtKeyUsageBin()};X509.getExtKeyUsageString=function(b){var a=new X509();a.readCertHex(b);return a.getExtKeyUsageString()};X509.getExtSubjectKeyIdentifier=function(b){var a=new X509();a.readCertHex(b);return a.getExtSubjectKeyIdentifier()};X509.getExtAuthorityKeyIdentifier=function(b){var a=new X509();a.readCertHex(b);return a.getExtAuthorityKeyIdentifier()};X509.getExtExtKeyUsageName=function(b){var a=new X509();a.readCertHex(b);return a.getExtExtKeyUsageName()};X509.getExtSubjectAltName=function(b){var a=new X509();a.readCertHex(b);return a.getExtSubjectAltName()};X509.getExtCRLDistributionPointsURI=function(b){var a=new X509();a.readCertHex(b);return a.getExtCRLDistributionPointsURI()};X509.getExtAIAInfo=function(b){var a=new X509();a.readCertHex(b);return a.getExtAIAInfo()};X509.getSignatureAlgorithmName=function(b){var a=new X509();a.readCertHex(b);return a.getSignatureAlgorithmName()};X509.getSignatureValueHex=function(b){var a=new X509();a.readCertHex(b);return a.getSignatureValueHex()};X509.getSerialNumberHex=function(b){var a=new X509();a.readCertHex(b);return a.getSerialNumberHex()};X509.verifySignature=function(c,b){var a=new X509();a.readCertHex(c);return a.verifySignature(b)};